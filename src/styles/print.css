/* -----------------------------------------------------------
   Print system — screen preview + print hardening
   ----------------------------------------------------------- */

/* Theme tokens used only for on-screen preview */
:root { color-scheme: light dark; }
:root[data-theme="dark"] { --bg:#111; --fg:#eee; --card:#1b1b1b; --border:#333; }
:root[data-theme="light"]{ --bg:#fff; --fg:#111; --card:#fff;    --border:#ddd; }

/* Print/layout variables */
:root{
  --print-header-h: 18mm; /* repeated header height */
  --print-gap: 8px;       /* gap between cards */
}

/* Screen preview background */
body{ background:var(--bg); color:var(--fg); }

/* Base card preview colors (real print uses white anyway) */
.print-card{ background:var(--card); border-color:var(--border); }

/* -----------------------------------------------------------
   PRINT HEADER + BASE
   ----------------------------------------------------------- */
@media print {
  html, body { height:auto; }
  body { margin:0; -webkit-print-color-adjust:exact; print-color-adjust:exact; }
  .no-print { display:none !important; }

  /* Fixed header that repeats on every page */
  .print-header{
    position:fixed; inset:0 0 auto 0;
    height:var(--print-header-h);
    background:#fff; border-bottom:1px solid #ccc;
    display:flex; align-items:end; justify-content:space-between;
    padding:6mm 10mm 4mm; z-index:9999;
  }
  .print-header h1{
    font-size:14pt; line-height:1.1; margin:0; text-wrap:balance;
  }
  .print-header .meta{ font-size:9pt; opacity:.85; }

  /* Compensate the header height */
  .print-content{ padding-top:calc(var(--print-header-h) + 2mm); }
}
/* Page size is injected dynamically via <style media="print"> */

/* -----------------------------------------------------------
   GRID + CARD (applies for preview and print)
   ----------------------------------------------------------- */

/* Grid for print with smaller gaps */
.print-grid{
  display:grid;
  grid-template-columns:repeat(var(--cols,3),1fr);
  gap:var(--print-gap);
}

/* Card block */
.print-card{
  break-inside:avoid; page-break-inside:avoid;
  border:1px solid var(--border, #bbb);
  border-radius:8px; padding:10px;
  background:#fff; color:#111;
  /* readability */
  hyphens:auto; -webkit-hyphens:auto; overflow-wrap:anywhere;
  orphans:3; widows:3;
}

.print-card h3{
  margin:0 0 4px; font-size:1.05em; line-height:1.2;
}
.print-card h3 small{ font-weight:500; font-size:14px; opacity:.7; }

/* Pills row */
.print-card .pills{
  display:flex; flex-wrap:wrap; gap:4px;
  margin:4px 0 6px;
}
.print-card .pill{
  display:inline-flex; align-items:center;
  font-size:.8em; line-height:1;
  border:1px solid var(--border, #ccc);
  border-radius:999px; padding:1px 6px;
  background:transparent; color:#111;
  /* avoid weird breaks inside a pill */
  hyphens:none; -webkit-hyphens:none; white-space:nowrap;
}

/* Body text */
.print-card .body{ font-size:.95em; line-height:1.25; }

/* Densities – only typographic scaling */
.print-S{ font-size:10px; }
.print-M{ font-size:12px; }
.print-L{ font-size:14px; }

/* Optional cut marks */
.cutmarks{ position:relative; }
.cutmarks::before,
.cutmarks::after{
  content:""; position:absolute; left:0; right:0;
  border-top:1px dotted #aaa; top:-4px;
}
.cutmarks::after{ top:auto; bottom:-4px; }

/* Manual page break between front and back pages */
.print-page-break{ break-before:page; }

/* Screen-only helpers (drag cursor, etc.) */
@media screen{
  .print-grid>div[draggable="true"]{ cursor:grab; }
  .print-grid>div[draggable="true"]:active{ cursor:grabbing; }
}

/* -----------------------------------------------------------
   HARDENING (last, minimal !important) — prevents overrides
   ----------------------------------------------------------- */
.print-grid{
  display:grid !important;
  grid-template-columns:repeat(var(--cols,3),1fr) !important;
  gap:var(--print-gap) !important;
}
.print-card .pills{
  display:flex !important; flex-wrap:wrap !important; gap:4px !important;
}
.print-card .pill + .pill{ margin-left:4px; } /* gap fallback for old engines */

/* Components container pill (print): group V/S/M */
.print-card .pill--components{
  display: inline-flex;
  align-items: center;
  gap: 4px;
  background: transparent;               /* print-safe */
  border: 1px solid currentColor;
  padding: 2px 6px;
  max-width: 100%;
  flex-wrap: wrap;
}

/* Avoid extra spacing on nested pills */
.print-card .pill--components .pill{ margin: 0; }

/* Inner component pills: dashed look to distinguish from others */
.print-card .pill--component{
  background: transparent;
  border: 1px dashed currentColor;
  font-weight: 700;
  white-space: nowrap;
}

/* Material text can be long: allow wrapping if needed */
.print-card .pill--component-m{ white-space: normal; }
